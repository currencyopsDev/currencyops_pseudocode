IMPORT numpy as np

IMPORT pandas as pd

IMPORT yfinance as yf

from tkinter IMPORT ttk

from tkinter IMPORT *

IMPORT table as tb

IMPORT calendarbuilder as cb

IMPORT os,sys,queue,threading,platform

from rssfeed IMPORT rssfeed

from search IMPORT searchbox

from marketsummary IMPORT marketsummary

from currencyconverter IMPORT openConverter

root=Tk()

IF platform.system()=="Linux":

    root.attributes('-zoomed', True)

ELSEIF platform.system()=="Windows":

    root.state('zoomed')

root.title("Currencyops")

root.tk.call("source", sys.path[0]+"/azure.tcl")

root.tk.call("set_theme", "dark")

tabControl=ttk.Notebook(root)

homepage=ttk.Frame(tabControl)

exchange=ttk.Frame(tabControl)

crypto=ttk.Frame(tabControl)

stocks=ttk.Frame(tabControl)

calendar=ttk.Frame(tabControl)

tabControl.add(homepage,text="Home Page")

tabControl.add(exchange,text="Exchange Rates")

tabControl.add(crypto,text="Cryptocurrencies")

tabControl.add(stocks,text="Stocks")

tabControl.add(calendar,text="Economic Calendar")

Label(exchange,text="Loading...").place(relx=.5, rely=.5, anchor="center")

Label(crypto,text="Loading...").place(relx=.5, rely=.5, anchor="center")

Label(stocks,text="Loading...").place(relx=.5, rely=.5, anchor="center")

tables=[[exchange,sys.path[0]+"/watchlist/exchange"],[crypto,sys.path[0]+"/watchlist/cryptocurrencies"],[stocks,sys.path[0]+"/watchlist/stocks"]]

q=queue.Queue()

FOR table IN tables:

    q.put(table)

DEFINE FUNCTION tableloader():

    WHILE not q.empty():

        tableinfo=q.get()

        rootframe=tableinfo[0]

        watchlistpath=tableinfo[1]

        tb.tableBuilder(rootframe, watchlistpath)

        q.task_done()

theme="dark"

DEFINE FUNCTION change_theme():

    global theme

    IF theme=="dark":

        root.tk.call("set_theme", "light")

        theme="light"

    ELSE:

        root.tk.call("set_theme", "dark")

        theme="dark"

SET worker TO threading.Thread(target=tableloader, daemon=True)

worker.start()

optionfield=Frame(homepage)

currencyconverter =Button(optionfield, text='Currency Converter', command=openConverter,height=1,relief=GROOVE,borderwidth=2)

currencyconverter.pack(side=LEFT,pady=(0, 5))

switch =ttk.Checkbutton(optionfield, text='Switch Theme', style='Switch.TCheckbutton', command=change_theme)

switch.pack(side=RIGHT)

optionfield.pack(side=TOP,fill=X)

scrollframe=cb.calendarBuilder(calendar)

separator =ttk.Separator(homepage, orient='horizontal').pack(fill=X)

marketsummary=marketsummary(homepage,["^IXIC","^DJI","AAPL","BTC-USD","GC=F","NFLX"])

separator =ttk.Separator(homepage, orient='horizontal').pack(fill=X)

searchbox=searchbox(homepage)

feeds=rssfeed(homepage)

tabControl.pack(expand=1,fill="both")

root.mainloop()

