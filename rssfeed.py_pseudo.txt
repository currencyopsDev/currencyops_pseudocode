IMPORT feedparser

IMPORT webbrowser

from functools IMPORT partial

from tkinter IMPORT *

from tkinter IMPORT ttk

DEFINE CLASS rssfeed():

    DEFINE FUNCTION getfeeds(self,url):

        feeds=[]

        SET d TO feedparser.parse(url)

        FOR feed IN d.entries:

            feeds.append([feed.title,feed.link])

        RETURN feeds

    DEFINE FUNCTION openNews(self,feed):

        webbrowser.open(feed[1])

    DEFINE FUNCTION maketable(self,rootframe,feeds):

        root=rootframe

        SET main_frame TO Frame(root,highlightbackground="black",highlightthickness="1")

        main_frame.pack(fill=BOTH,side=RIGHT)

        Label(main_frame,text="NEWS",justify="center").pack(fill=X,side=TOP,anchor=NW)

        ttk.Separator(main_frame).pack(fill=X,side=TOP)

        my_canvas=Canvas(main_frame)

        my_canvas.pack(side=LEFT,fill=BOTH)

        SET my_scrollbar TO ttk.Scrollbar(main_frame, orient=VERTICAL, command=my_canvas.yview)

        my_scrollbar.pack(side=RIGHT, fill=Y,anchor="w")

        my_canvas.configure(yscrollcommand=my_scrollbar.set)

        SET my_canvas.bind('<Configure>', lambda e: my_canvas.configure(scrollregion TO my_canvas.bbox("all")))

        SET second_frame TO Frame(my_canvas)

        my_canvas.create_window((0,0), window=second_frame, anchor="w")

        FOR i IN range(0,len(feeds)):

            feed=feeds[i]

            feedtitle=feed[0]

            feedlink=feed[1]

            Button(second_frame,text=feedtitle,relief="flat",wraplength=350,command=partial(self.openNews,feed)).grid(row=i,column=0)

    DEFINE FUNCTION __init__(self,rootframe):

        feeds=self.getfeeds("http://feeds.marketwatch.com/marketwatch/marketpulse/")

        self.maketable(rootframe, feeds)

